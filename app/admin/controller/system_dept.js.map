{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\system_dept.js"
    ],
    "names": [],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\system_dept.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from './base.js';\n\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction(){\n    //auto render template file index_index.html\n    let page_index=this.get(\"page\");\n    let name=this.get(\"name\");\n    let search={};\n    if(name&&name.length>0){\n      search.name=['like','%'+name+'%'];\n    }\n    this.assign(\"name\",name);\n    if(!page_index) page_index=1;\n    let page_count=10;\n    let model=this.model(\"v_department\");\n\n    let raw_data=await model.page(page_index,page_count).where(search).countSelect();\n    this.assign(\"staffs\",raw_data.data);\n    this.assign(\"currentPage\",raw_data.currentPage);\n    this.assign(\"itemsCount\",raw_data.count);\n    this.assign(\"totalPages\",raw_data.totalPages);\n    this.assign(\"startPage\",(page_index-1)*page_count+1);\n    this.assign(\"endPage\",Math.min(page_index*page_count,raw_data.count));\n    return this.display();\n  }\n  /**\n  * update action\n  * 更新\n  * @return {Promise} []\n  */\n  async updateAction(){\n    if(this.isGet()){\n      let id=this.get(\"id\");\n      let model=this.model(\"department\");\n      let data=await model.where({id:id}).find();\n      let p_depts=await model.order(\"name\").select();\n      this.assign(\"dept\",data);\n      this.assign(\"p_depts\",p_depts);\n      return this.display();\n    }else{\n      let name=this.post(\"name\"),deleted=!!this.post(\"deleted\"),id=this.post(\"id\"),puuid=this.post(\"puuid\");\n\n      let updatedat=new Date();\n      let to_update={name:name,deleted:deleted,updatedat:updatedat.toLocaleString(),puuid:puuid&&puuid.length>0?puuid:null}\n\n      //插入数据\n      let model=this.model(\"department\");\n\n      await model.where({id:id}).update(to_update);\n      return this.redirect(\"/system_dept\");\n    }\n  }\n\n  /**\n  * insert action\n  * 插入\n  * @return {Promise} []\n  */\n  async insertAction(){\n    if(this.isGet()){\n      let model=this.model('department');\n      let data=model.order(\"name\").select();\n      this.assign(\"p_depts\",data);\n      return this.display();\n    }\n    let name=this.post(\"name\"),deleted=!!this.post(\"deleted\"),puuid=this.post(\"puuid\");\n    let uuid=require('uuid');\n\n    //插入数据\n    let model=this.model(\"department\");\n    let createdat=new Date();\n    let updatedat=new Date();\n\n    await model.add({\n      name:name,\n      puuid:puuid&&puuid.length>0?puuid:null,\n      deleted:deleted,\n      createdat:createdat.toLocaleString(),\n      updatedat:updatedat.toLocaleString(),\n      uuid:uuid.v4().toString()\n    });\n    return this.redirect(\"/system_dept\");\n  }\n\n  /**\n  * delete action\n  * 删除\n  * @return {Promise} []\n  */\n  async deleteAction(){\n    if(this.isGet()){\n      this.assign(\"id\",this.get(\"id\"));\n      return this.display();\n    }\n    let id=this.post(\"id\");\n    let model=this.model(\"department\");\n    await model.where({id:id}).delete();\n    return this.redirect(\"/system_dept\");\n  }\n}\n"
    ]
}