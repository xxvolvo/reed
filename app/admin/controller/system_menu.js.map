{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\system_menu.js"
    ],
    "names": [],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\system_menu.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from './base.js';\n\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction(){\n    //auto render template file index_index.html\n    let page_index=this.get(\"page\");\n    let name=this.get(\"name\");\n    let search={};\n    if(name&&name.length>0){\n      search.name=['like','%'+name+'%'];\n    }\n    this.assign(\"name\",name);\n    if(!page_index) page_index=1;\n    let page_count=10;\n\n    let model=this.model(\"v_menu\");\n\n    let raw_data=await model.page(page_index,page_count).where(search).countSelect();\n    this.assign(\"menus\",raw_data.data);\n    this.assign(\"currentPage\",raw_data.currentPage);\n    this.assign(\"itemsCount\",raw_data.count);\n    this.assign(\"totalPages\",raw_data.totalPages);\n    this.assign(\"startPage\",(page_index-1)*page_count+1);\n    this.assign(\"endPage\",Math.min(page_index*page_count,raw_data.count));\n    return this.display();\n  }\n  /**\n  * update action\n  * 更新\n  * @return {Promise} []\n  */\n  async updateAction(){\n    if(this.isGet()){\n      let model_p=this.model(\"menu\");\n      let data_p=model_p.order(\"name\").select();\n      this.assign(\"pmenus\",data_p);\n\n      let id=this.get(\"id\");\n      let model=this.model(\"menu\");\n      let data=await model.where({id:id}).find();\n      this.assign(\"menu\",data);\n      return this.display();\n    }else{\n      let id=this.post(\"id\"),\n          name=this.post(\"name\"),\n          deleted=!!this.post(\"deleted\"),\n          sort_num=this.post(\"sort_num\"),\n          icon=this.post(\"icon\"),\n          href=this.post(\"href\"),\n          controller=this.post(\"controller\"),\n          puuid=this.post(\"puuid\");\n\n      let updatedat=new Date();\n      let to_update={\n        name:name,\n        sort_num:sort_num,\n        icon:icon,\n        href:href,\n        controller:controller,\n        puuid:puuid&&puuid.length>0?puuid:null,\n        deleted:deleted,\n        updatedat:updatedat.toLocaleString()}\n\n      //更新数据\n      let model=this.model(\"menu\");\n\n      await model.where({id:id}).update(to_update);\n      return this.redirect(\"/system_menu\");\n    }\n  }\n\n  /**\n  * insert action\n  * 插入\n  * @return {Promise} []\n  */\n  async insertAction(){\n    if(this.isGet()){\n      let model=this.model(\"menu\");\n      let data=model.order(\"name\").select();\n      this.assign(\"pmenus\",data);\n      return this.display();\n    }\n    let name=this.post(\"name\"),\n        deleted=!!this.post(\"deleted\"),\n        sort_num=this.post(\"sort_num\"),\n        icon=this.post(\"icon\"),\n        href=this.post(\"href\"),\n        controller=this.post(\"controller\"),\n        puuid=this.post(\"puuid\");\n    let uuid=require('uuid');\n\n    //插入数据\n    let model=this.model(\"menu\");\n    let createdat=new Date();\n    let updatedat=new Date();\n\n    await model.add({\n      name:name,\n      deleted:deleted,\n      sort_num:sort_num,\n      icon:icon,\n      href:href,\n      controller:controller,\n      puuid:puuid&&puuid.length>0?puuid:null,\n      createdat:createdat.toLocaleString(),\n      updatedat:updatedat.toLocaleString(),\n      uuid:uuid.v4().toString()\n    });\n    return this.redirect(\"/system_menu\");\n  }\n\n  /**\n  * delete action\n  * 删除\n  * @return {Promise} []\n  */\n  async deleteAction(){\n    if(this.isGet()){\n      this.assign(\"id\",this.get(\"id\"));\n      return this.display();\n    }\n    let id=this.post(\"id\");\n    let model=this.model(\"menu\");\n    await model.where({id:id}).delete();\n    return this.redirect(\"/system_menu\");\n  }\n}\n"
    ]
}